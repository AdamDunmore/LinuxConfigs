const player = await Service.import('mpris')

function checkPlayer(s){
    if (s.players[0] == undefined){
        now_playing_title.set_label("Nothings playing");
        now_playing_artist.set_label("");
        now_playing_cover.hide()
    }
    else{
        now_playing_title.set_label(s.players[0].track_title)
        now_playing_artist.set_label(s.players[0].track_artists[0])
        if (s.players[0].track_cover_url == ""){
        }
        else{
            //now_playing_cover.show()
            //now_playing_cover.setCss(`background-image: url('${s.players[0].track_cover_url}')`)
            Player.show()
            Player.setCss(`background-image: url('${s.players[0].track_cover_url}')`)
        }
    }
}

player.connect('changed', function(s){
    checkPlayer(s)
})

const now_playing_title = Widget.Label({
        label: "",
        className: "now_playing_info_title",
        wrap: true
})


const now_playing_artist = Widget.Label({
        label: "",
        className: "now_playing_info_artist",
})

const Player = Widget.Box({
    className: "now_playing_container now_playing_cover now_playing_info",
    orientation: 1,
    vexpand: true,
    hexpand: true,
    children: [
        now_playing_title,
        now_playing_artist,
    ]
})

checkPlayer(player)

export default Player;
